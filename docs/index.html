<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Share Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles to ensure the drag area is visible and works */
        #drop-zone {
            border: 2px dashed #cbd5e1; /* slate-300 */
            transition: all 0.2s;
        }
        #drop-zone.drag-over {
            border-color: #3b82f6; /* blue-500 */
            background-color: #eff6ff; /* blue-50 */
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="bg-white rounded-xl shadow-2xl p-8 w-full max-w-lg">
        <h1 class="text-3xl font-bold text-gray-800 mb-4 text-center">üîí Secure Share Prototype</h1>
        
        <div class="flex mb-4 p-1 bg-gray-100 rounded-lg">
            <button id="fileModeBtn" onclick="setMode('file')" class="flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors duration-200 bg-blue-500 text-white shadow-md">
                üìÇ Encrypt File
            </button>
            <button id="textModeBtn" onclick="setMode('text')" class="flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-colors duration-200 text-gray-600 hover:bg-white">
                üìù Encrypt Text
            </button>
        </div>

        <div id="fileMode" class="space-y-4">
            <div id="drop-zone" class="p-6 text-center border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 transition-colors">
                <input type="file" id="fileInput" class="hidden">
                <p class="text-gray-500" id="fileInstruction">Drag and drop a file here, or <span class="text-blue-500 font-semibold">click to select</span>.</p>
                <p class="text-gray-700 font-semibold mt-1" id="fileNameDisplay"></p>
            </div>
            
            <input type="password" id="passphrase" placeholder="Enter Secret Passphrase" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
        </div>

        <div id="textMode" class="space-y-4 hidden">
            <textarea id="textInput" rows="4" placeholder="Enter your secret message here..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500"></textarea>
            
            <input type="password" id="passphraseText" placeholder="Enter Secret Passphrase" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
        </div>

        <div class="space-y-4 mt-4">
            <div>
                <label for="expiration" class="block text-sm font-medium text-gray-700 mb-1">Expiration Time (TTL):</label>
                <select id="expiration" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    <option value="0">Never (Manual Deletion Required)</option>
                    <option value="3600000">1 Hour</option>
                    <option value="86400000">1 Day</option>
                    <option value="604800000">7 Days</option>
                </select>
            </div>
            
            <button onclick="encryptAndUpload()" class="w-full py-3 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 transition duration-150">
                Encrypt & Share Securely
            </button>

            <div id="progressBarContainer" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-1">Upload Progress:</label>
                <progress id="uploadProgressBar" value="0" max="100" class="w-full h-3 rounded-full overflow-hidden [&::-webkit-progress-bar]:bg-gray-200 [&::-webkit-progress-value]:bg-blue-500"></progress>
            </div>
            
            <div id="statusMessage" class="p-4 bg-gray-50 border border-gray-200 rounded-lg text-gray-700">Awaiting input...</div>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>

    <script>
      // Your web app's Firebase configuration (COPIED FROM FIREBASE CONSOLE)
      // NOTE: DO NOT CHANGE THE VARIABLE NAMES, ONLY THE VALUES
      const firebaseConfig = {
        apiKey: "AIzaSyBMcG...", 
        authDomain: "securing-app.firebaseapp.com",
        projectId: "securing-app",
        storageBucket: "securing-app.firebasestorage.app",
        messagingSenderId: "1005545403992",
        appId: "1:1005545403992:web:eb524658db38b2df7b7c2d",
        measurementId: "G-H8MVQKP75K"
      };

      // Initialize Firebase App
      firebase.initializeApp(firebaseConfig);
      
      // Initialize Firestore (for metadata) and Storage (for large files)
      const db = firebase.firestore();
      const storage = firebase.storage();
    </script>

    <script src="app.js"></script>
    <script>
        // Set initial mode on load
        setMode('file');
    </script>
</body>
</html>
